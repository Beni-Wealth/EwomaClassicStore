<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Register — Ewoma Classic Store</title>

  <!-- logo (favicon + page) -->
  <link rel="icon" type="image/png" sizes="32x32" href="https://res.cloudinary.com/dq7fpxfbc/image/upload/v1763817088/IMG-20250110-WA0108_pgxmqj.jpg">
  <meta name="theme-color" content="#0f61ff">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <style>
    :root{
      --bg-1: #f5f8ff;
      --bg-2: #ffffff;
      --primary: #0f61ff;       /* blue */
      --primary-600: #0753e6;
      --glass: rgba(15,97,255,0.06);
      --muted: #52607a;
      --card-radius: 14px;
      --shadow: 0 10px 30px rgba(16,24,40,0.06);
      --max-width: 1100px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;background:linear-gradient(180deg,var(--bg-1),var(--bg-2));color:#0b1220;-webkit-font-smoothing:antialiased}
    .page{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
    .frame{width:100%;max-width:var(--max-width);display:grid;grid-template-columns:1fr 420px;gap:36px;align-items:center}
    /* hero */
    .hero{
      background:linear-gradient(180deg, rgba(15,97,255,0.06), rgba(15,97,255,0.02));
      border-radius:var(--card-radius);
      padding:36px;
      box-shadow:var(--shadow);
      min-height:420px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:18px;
    }
    .hero-top{display:flex;gap:18px;align-items:center}
    .logo {
      width:84px;height:84px;border-radius:10px;flex-shrink:0;
      background-image:url('https://res.cloudinary.com/dq7fpxfbc/image/upload/v1763817088/IMG-20250110-WA0108_pgxmqj.jpg');
      background-size:cover;background-position:center;border:1px solid rgba(15,97,255,0.08);
      box-shadow: 0 8px 30px rgba(15,97,255,0.06);
    }
    .hero h1{margin:0;font-size:28px;color:var(--primary-600);letter-spacing:-0.2px}
    .hero p{margin:0;color:var(--muted);line-height:1.45;font-size:15px;max-width:56ch}
    .features{display:flex;gap:10px;flex-wrap:wrap;margin-top:6px}
    .pill{background:var(--glass);padding:8px 12px;border-radius:999px;color:var(--primary);font-weight:700;font-size:13px}

    /* card / form */
    .card{
      background: #ffffff;
      border-radius:var(--card-radius);
      padding:22px;
      box-shadow:var(--shadow);
      border: 1px solid rgba(10,20,50,0.02);
    }
    .card h2{margin:0 0 8px;font-size:18px}
    label{display:block;font-size:13px;color:var(--muted);margin-top:12px}
    input[type="text"],input[type="email"],input[type="tel"],input[type="password"]{
      width:100%;padding:12px 14px;border-radius:10px;border:1px solid #e8eef8;font-size:15px;margin-top:8px;background:#fff;outline:none;box-shadow:none;
    }
    input:focus{border-color:var(--primary);box-shadow:0 6px 18px rgba(15,97,255,0.06)}
    .hint{font-size:13px;color:#94a3b8;margin-top:10px}
    .submit{margin-top:18px;display:block;width:100%;padding:12px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--primary),var(--primary-600));color:white;font-weight:700;font-size:15px;cursor:pointer}
    .submit[disabled]{opacity:0.6;cursor:default}
    .msg{margin-top:12px;padding:10px;border-radius:10px;font-size:14px}
    .msg.success{background:#ecfdf5;color:#065f46;border:1px solid #bbf7d0}
    .msg.error{background:#fff1f2;color:#7f1d1d;border:1px solid #fecaca}

    /* footer small text */
    .small{font-size:13px;color:var(--muted);margin-top:10px;text-align:center}

    /* responsive */
    @media (max-width:980px){
      .frame{grid-template-columns:1fr;gap:18px;padding:8px}
      .hero{min-height:180px;padding:20px}
      .card{padding:18px}
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="frame" role="main" aria-labelledby="signup-title">

      <section class="hero" aria-hidden="false">
        <div class="hero-top">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <div class="pill">EwomaClassicStore</div>
            <h1 id="signup-title">Quality at affordable prices.</h1>
            <div class="hint" style="margin-top:8px">Bulk purchases • Single items • Accessories, wigs & gadgets. Shop confidently with our secure checkout and fast delivery.</div>
          </div>
        </div>

        <p>Register for an account to manage orders, track deliveries, save favourites, and access exclusive deals. Use the same account across desktop and mobile — everything syncs instantly.</p>

        <div class="features" aria-hidden="true">
          <div style="background:#fff;padding:10px 12px;border-radius:10px;border:1px solid rgba(15,97,255,0.04)">Secure payments</div>
          <div style="background:#fff;padding:10px 12px;border-radius:10px;border:1px solid rgba(15,97,255,0.04)">Fast delivery</div>
          <div style="background:#fff;padding:10px 12px;border-radius:10px;border:1px solid rgba(15,97,255,0.04)">Easy returns</div>
        </div>
      </section>

      <aside class="card" aria-label="Registration form">
        <h2>Create an account</h2>

        <form id="registerForm" autocomplete="on" novalidate>
          <label for="fullName">Full name</label>
          <input id="fullName" name="fullName" type="text" required minlength="2" placeholder="Jane Doe" />

          <label for="email">Email address</label>
          <input id="email" name="email" type="email" required placeholder="you@example.com" inputmode="email" />

          <label for="phone">Phone (optional)</label>
          <input id="phone" name="phone" type="tel" placeholder="+2348012345678" inputmode="tel" />

          <label for="password">Password</label>
          <input id="password" name="password" type="password" required minlength="6" placeholder="At least 6 characters" />

          <label for="confirmPassword">Confirm password</label>
          <input id="confirmPassword" name="confirmPassword" type="password" required minlength="6" placeholder="Repeat your password" />

          <button id="submitBtn" class="submit" type="submit" aria-live="polite" aria-atomic="true">
            <span class="btn-text">Create account</span>
          </button>

          <div id="message" role="status" aria-live="polite"></div>

          <div class="small">Already have an account? <a href="login.html" style="color:var(--primary);text-decoration:none">Sign in</a></div>
        </form>
      </aside>

    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, updateProfile, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
    import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    // === EwomaClassicStore Firebase config (kept same as you provided) ===
    const firebaseConfig = {
      apiKey: "AIzaSyDo8QfyV3FxWtZMgRI-VvxGJWxLErosIZo",
      authDomain: "ewomaclassicstore-43b5e.firebaseapp.com",
      projectId: "ewomaclassicstore-43b5e",
      storageBucket: "ewomaclassicstore-43b5e.firebasestorage.app",
      messagingSenderId: "294976130252",
      appId: "1:294976130252:web:8520570810950d64e14669",
      measurementId: "G-HHG3KC5VZ3"
    };

    // initialize
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // DOM
    const form = document.getElementById('registerForm');
    const messageEl = document.getElementById('message');
    const submitBtn = document.getElementById('submitBtn');

    function showMessage(text, type='success'){
      messageEl.innerHTML = '';
      const d = document.createElement('div');
      d.className = 'msg ' + (type==='success'?'success':'error');
      d.textContent = text;
      messageEl.appendChild(d);
    }

    function setLoading(loading){
      if(loading){
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<span style="display:inline-block;width:18px;height:18px;border:3px solid rgba(255,255,255,0.35);border-top-color:white;border-radius:50%;animation:spin 1s linear infinite;margin-right:10px"></span><span class="btn-text">Creating account...</span>';
      } else {
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<span class="btn-text">Create account</span>';
      }
    }

    // redirect to login if the user is already signed in
    onAuthStateChanged(auth, (user) => {
      if(user){
        // Already signed in -> go to login (as requested)
        window.location.href = 'login.html';
      }
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      messageEl.innerHTML = '';

      const fullName = form.fullName.value.trim();
      const email = form.email.value.trim();
      const phone = form.phone.value.trim();
      const password = form.password.value;
      const confirmPassword = form.confirmPassword.value;

      // validations
      if(!fullName || !email || !password || !confirmPassword){
        showMessage('Please fill all required fields.', 'error'); return;
      }
      if(password !== confirmPassword){
        showMessage('Passwords do not match.', 'error'); return;
      }
      if(password.length < 6){
        showMessage('Password must be at least 6 characters.', 'error'); return;
      }

      setLoading(true);

      try {
        // create user
        const cred = await createUserWithEmailAndPassword(auth, email, password);
        const u = cred.user;

        // set display name
        try { await updateProfile(u, { displayName: fullName }); } catch(err){ console.warn('updateProfile failed', err); }

        // create user doc
        const userDoc = {
          uid: u.uid,
          fullName,
          email,
          phone: phone || null,
          createdAt: serverTimestamp()
        };
        await setDoc(doc(db, 'users', u.uid), userDoc);

        // success -> redirect to login.html
        window.location.href = 'login.html';
      } catch(err) {
        console.error('Registration error', err);
        // Show friendly message
        const msg = err && err.code ? (err.message || 'Registration failed.') : (err.message || 'Registration failed.');
        showMessage(msg, 'error');
      } finally {
        setLoading(false);
      }
    });

    // small spinner CSS injection (used by setLoading)
    (function addSpinKeyframe(){
      const s = document.createElement('style');
      s.innerHTML = '@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}';
      document.head.appendChild(s);
    })();
  </script>
</body>
  </html>
  
