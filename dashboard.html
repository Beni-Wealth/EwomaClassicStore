<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Account ‚Äî EwomaClassicStore</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <!-- favicon: the image you provided (place file next to this HTML or change href to your hosted URL) -->
  <link rel="icon" type="image/png" href="ff32c8e3-7d29-4ae5-921d-0b283688feac.jpg">

  <style>
    :root{
      --bg: #f5f9ff;
      --white: #ffffff;
      --primary: #0b78ff; /* blue */
      --muted: #6b7280;
      --card: #ffffff;
      --radius: 12px;
      --nav-height: 86px; /* space reserved for bottom nav */
      font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:#07203a}
    a{color:inherit;text-decoration:none}
    body{
      -webkit-font-smoothing:antialiased;
      /* keep small safe area padding, wrap will be full screen */
      padding:0;
      margin:0;
    }

    /* full-bleed wrap that fills the viewport */
    .wrap{
      position:fixed;
      top:0; left:0; right:0; bottom:0;
      display:flex;
      flex-direction:column;
      background:var(--white);
      overflow:hidden;
      /* keep subtle border and shadow on wide screens */
      border-top: 12px solid transparent;
    }

    /* scrollable content area so header and bottom nav remain visible */
    .content {
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      background: linear-gradient(180deg,var(--bg),#fff);
      padding-bottom: calc(var(--nav-height) + env(safe-area-inset-bottom, 20px));
      min-height:0; /* allow flex child to shrink */
    }

    /* header/search area (remains at top inside content) */
    .top{
      padding:14px;
      display:flex;
      gap:12px;
      align-items:center;
      background:linear-gradient(180deg,#f7fbff,#ffffff);
      border-bottom:1px solid rgba(8,48,71,0.03);
    }
    .search{
      flex:1; display:flex; align-items:center; gap:10px; background:#f1f7ff; border-radius:10px; padding:10px 12px;
      border:1px solid rgba(11,120,255,0.06);
    }
    .search input{border:0;background:transparent;outline:none;font-size:14px}
    .login-btn{
      background:var(--primary); color:#fff; padding:8px 12px; border-radius:10px; font-weight:600; border:0;
      flex-shrink:0;
    }

    /* welcome card (top of content) */
    .card{
      padding:18px;
      display:flex;
      gap:14px;
      align-items:center;
      border-bottom:1px solid rgba(8,48,71,0.03);
      background:linear-gradient(180deg,#fff,#fbfeff);
    }
    .avatar{
      width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--primary),#0a4fb3);
      display:grid;place-items:center;color:#fff;font-weight:800;font-size:22px;flex-shrink:0;
    }
    .welcome{flex:1;min-width:0}
    .welcome h3{margin:0;font-size:18px;color:#083047;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    .welcome p{margin:6px 0 0;color:var(--muted);font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}

    .big-btn-inline{padding:10px 14px;border-radius:10px;background:var(--primary);color:#fff;font-weight:700;border:0;box-shadow:0 8px 20px rgba(11,120,255,0.12)}

    /* Live chat callout & list */
    .panel{padding:14px;border-bottom:1px solid rgba(8,48,71,0.03)}
    .live-callout{display:block;padding:12px;border-radius:10px;background:#ff9800;color:#fff;font-weight:700;text-align:center}

    .list{display:flex;flex-direction:column;gap:8px}
    .item{
      display:flex;align-items:center;justify-content:space-between;padding:14px;border-radius:10px;background:var(--card);
      border:1px solid rgba(8,48,71,0.03); margin:0 14px;
    }
    .item-left{display:flex;align-items:center;gap:12px;min-width:0}
    .icon{
      width:44px;height:44px;border-radius:10px;background:#eef7ff;display:grid;place-items:center;color:var(--primary);font-weight:800;font-size:18px;
      flex-shrink:0;
    }
    .item-text{display:flex;flex-direction:column;min-width:0}
    .item-text strong{font-size:15px;color:#083047;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    .item-text small{font-size:13px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    .chev{color:var(--muted);font-size:20px;margin-left:8px;flex-shrink:0}

    .section{padding:14px;border-top:1px dashed rgba(8,48,71,0.04);font-size:13px;color:var(--muted);margin:0 14px 18px 14px}
    .section a{color:var(--primary);font-weight:600}

    /* floating bottom navigation */
    .bottom {
      position:fixed; left:50%; transform:translateX(-50%);
      bottom:12px; width:min(980px,calc(100% - 24px));
      background:#fff;border-radius:14px;box-shadow:0 18px 40px rgba(8,48,71,0.12);
      display:flex;justify-content:space-around;align-items:center;padding:10px 12px; gap:6px;
      z-index:9999; height:var(--nav-height);
    }
    .nav-item{display:flex;flex-direction:column;align-items:center;gap:8px;color:var(--muted);font-size:12px}
    .nav-item.active{color:var(--primary);font-weight:700}
    .nav-icon{width:56px;height:56px;border-radius:12px;display:grid;place-items:center;background:#f1f7ff;color:var(--primary);font-weight:800}

    /* responsive tweaks */
    @media (max-width:420px){
      .avatar{width:56px;height:56px;font-size:20px}
      .icon{width:40px;height:40px}
      .nav-icon{width:48px;height:48px}
    }
    @media (min-width:900px){
      .avatar{width:72px;height:72px}
      .icon{width:48px;height:48px}
      .item{padding:16px; margin:0 18px}
      .section{margin:0 18px 22px 18px}
    }
  </style>
</head>
<body>
  <div class="wrap" role="main" aria-label="Account dashboard (full screen)">
    <div class="content">
      <!-- top area -->
      <div class="top" role="region" aria-label="top actions">
        <div class="search" aria-hidden="false">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.35-4.35" stroke="#0b78ff" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="#0b78ff" stroke-width="1.6"/></svg>
          <input id="searchInput" placeholder="Search products" aria-label="Search products">
        </div>
        <button id="loginBtn" class="big-btn-inline">Login</button>
      </div>

      <!-- welcome -->
      <div class="card" role="region" aria-label="welcome">
        <div class="avatar" id="avatar">E</div>
        <div class="welcome">
          <h3 id="welcomeTitle">Welcome</h3>
          <p id="welcomeSub">Enter your account</p>
        </div>
        <div style="min-width:140px;text-align:right">
          <button id="openLogin" class="big-btn-inline" style="max-width:220px">Login</button>
        </div>
      </div>

      <!-- live chat / callout -->
      <div class="panel">
        <div class="live-callout" id="liveChat">Live Chat</div>
      </div>

      <!-- list -->
      <div class="panel" style="padding-top:0;padding-bottom:8px">
        <div class="list" role="list" aria-label="Account options">
          <a class="item" href="help.html" role="listitem">
            <div class="item-left">
              <div class="icon">i</div>
              <div class="item-text"><strong>Help & Support</strong><small class="muted">Contact us for assistance</small></div>
            </div>
            <div class="chev" aria-hidden="true">‚Ä∫</div>
          </a>

          <button class="item" id="ordersItem" role="listitem">
            <div class="item-left">
              <div class="icon">üßæ</div>
              <div class="item-text"><strong>Orders</strong><small class="muted" id="ordersSub">View recent orders</small></div>
            </div>
            <div class="chev" aria-hidden="true">‚Ä∫</div>
          </button>

          <button class="item" id="inboxItem" role="listitem">
            <div class="item-left">
              <div class="icon">‚úâÔ∏è</div>
              <div class="item-text"><strong>Inbox</strong><small class="muted" id="inboxSub">Messages and updates</small></div>
            </div>
            <div class="chev" aria-hidden="true">‚Ä∫</div>
          </button>

          <a class="item" href="ratings.html" role="listitem">
            <div class="item-left">
              <div class="icon">‚òÖ</div>
              <div class="item-text"><strong>Ratings & Reviews</strong><small class="muted">See your feedback</small></div>
            </div>
            <div class="chev" aria-hidden="true">‚Ä∫</div>
          </a>

          <a class="item" href="recently-viewed.html" role="listitem">
            <div class="item-left">
              <div class="icon">‚ü≥</div>
              <div class="item-text"><strong>Recently Viewed</strong><small class="muted">Items you checked</small></div>
            </div>
            <div class="chev" aria-hidden="true">‚Ä∫</div>
          </a>
        </div>
      </div>

      <div class="section">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div class="muted">My account</div>
          <div><a href="orders.html">Manage orders</a></div>
        </div>
        <div style="margin-top:10px;font-size:13px" id="userMeta">Not signed in</div>
      </div>
    </div> <!-- /.content -->
  </div> <!-- /.wrap -->

  <!-- bottom nav -->
  <nav class="bottom" role="navigation" aria-label="main navigation">
    <a class="nav-item" href="index.html">
      <div class="nav-icon">üè†</div>
      <div>Home</div>
    </a>
    <a class="nav-item" href="categories.html">
      <div class="nav-icon">üìÇ</div>
      <div>Categories</div>
    </a>
    <a class="nav-item" href="cart.html">
      <div class="nav-icon">üõí</div>
      <div>Cart</div>
    </a>
    <a class="nav-item active" href="dashboard.html">
      <div class="nav-icon">üë§</div>
      <div>Account</div>
    </a>
  </nav>

  <!-- Firebase (modular CDN) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-analytics.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
    import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

    // FIREBASE CONFIG: ewomaclassicstore-43b5e (from you)
    const firebaseConfig = {
      apiKey: "AIzaSyDo8QfyV3FxWtZMgRI-VvxGJWxLErosIZo",
      authDomain: "ewomaclassicstore-43b5e.firebaseapp.com",
      projectId: "ewomaclassicstore-43b5e",
      storageBucket: "ewomaclassicstore-43b5e.firebasestorage.app",
      messagingSenderId: "294976130252",
      appId: "1:294976130252:web:8520570810950d64e14669",
      measurementId: "G-HHG3KC5VZ3"
    };

    const app = initializeApp(firebaseConfig);
    try { getAnalytics(app); } catch(e){}
    const auth = getAuth(app);
    const db = getFirestore(app);

    // UI refs
    const avatar = document.getElementById('avatar');
    const welcomeTitle = document.getElementById('welcomeTitle');
    const welcomeSub = document.getElementById('welcomeSub');
    const openLogin = document.getElementById('openLogin');
    const loginBtn = document.getElementById('loginBtn');
    const userMeta = document.getElementById('userMeta');
    const ordersSub = document.getElementById('ordersSub');
    const inboxSub = document.getElementById('inboxSub');

    // navigation actions
    openLogin.addEventListener('click', ()=> location.href = 'login.html');
    loginBtn.addEventListener('click', ()=> location.href = 'login.html');
    document.getElementById('ordersItem').addEventListener('click', ()=> location.href = 'orders.html');
    document.getElementById('inboxItem').addEventListener('click', ()=> location.href = 'inbox.html');

    // helper: count user docs
    async function countForUser(collectionName, userId){
      try{
        const q = query(collection(db, collectionName), where('userId', '==', userId));
        const snap = await getDocs(q);
        return snap.size;
      } catch(e){
        console.warn('countForUser error', e);
        return 0;
      }
    }

    onAuthStateChanged(auth, async (user) => {
      if(!user){
        avatar.textContent = 'E';
        welcomeTitle.textContent = 'Welcome';
        welcomeSub.textContent = 'Enter your account';
        userMeta.textContent = 'Not signed in';
        ordersSub.textContent = 'View recent orders';
        inboxSub.textContent = 'Messages and updates';
        openLogin.style.display = 'inline-block';
        loginBtn.style.display = 'inline-block';
        return;
      }

      openLogin.style.display = 'none';
      loginBtn.textContent = 'Account';
      const name = user.displayName || (user.email ? user.email.split('@')[0] : 'User');
      avatar.textContent = (name[0] || 'U').toUpperCase();
      welcomeTitle.textContent = `Welcome, ${name}`;
      welcomeSub.textContent = user.email || '';

      const ordersCount = await countForUser('orders', user.uid);
      const inboxCount = await countForUser('messages', user.uid);

      ordersSub.textContent = ordersCount ? `${ordersCount} orders` : 'No recent orders';
      inboxSub.textContent = inboxCount ? `${inboxCount} messages` : 'No new messages';
      userMeta.textContent = `Signed in as ${user.email || name} ‚Ä¢ UID: ${user.uid.slice(0,8)}`;

      loginBtn.addEventListener('click', async ()=>{
        try {
          await signOut(auth);
          window.location.href = 'login.html';
        } catch(e){
          console.error('signout', e);
          alert('Sign out failed, check console.');
        }
      });
    });

    // Live chat
    document.getElementById('liveChat').addEventListener('click', ()=> location.href = 'help.html');
  </script>
</body>
</html>
